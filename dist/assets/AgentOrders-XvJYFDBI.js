const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Ctx_GovF.js","assets/react-vendor-DBmefE3i.js","assets/icons-DYE8NDaX.js","assets/utils-CZ_YNEkO.js","assets/index-DZ3G8Qja.css"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,m=(e,s)=>{for(var a in s||(s={}))r.call(s,a)&&l(e,a,s[a]);if(t)for(var a of t(s))n.call(s,a)&&l(e,a,s[a]);return e},i=(e,t)=>s(e,a(t)),c=(e,s,a)=>new Promise((t,r)=>{var n=e=>{try{m(a.next(e))}catch(s){r(s)}},l=e=>{try{m(a.throw(e))}catch(s){r(s)}},m=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,l);m((a=a.apply(e,s)).next())});import{q as o,ad as d,j as u,l as g,g as N,y as x,P as b,J as p,D as h,h as y,S as j,a as D,N as f,a7 as v,p as w,_ as C}from"./index-Ctx_GovF.js";import{r as A}from"./react-vendor-DBmefE3i.js";import{f as O,g as E,b as U}from"./helpers-B6CJClH3.js";import"./icons-DYE8NDaX.js";import"./utils-CZ_YNEkO.js";function V(){var e,s,a,t;const{success:r,error:n}=o(),[l,C]=A.useState(null),[V,P]=A.useState([]),[_,I]=A.useState([]),[z,R]=A.useState(!0),[q,$]=A.useState(!1),[M,F]=A.useState(""),[T,L]=A.useState("all"),[B,J]=A.useState("all"),[K,G]=A.useState({page:1,limit:20,total:0,pages:0}),[H,Q]=A.useState(!1),[W,X]=A.useState(!1),[Y,Z]=A.useState(!1),[ee,se]=A.useState(!1),[ae,te]=A.useState(!1),[re,ne]=A.useState(null),[le,me]=A.useState([]),[ie,ce]=A.useState(!1),[oe,de]=A.useState(!1),[ue,ge]=A.useState(!1),[Ne,xe]=A.useState({customerId:"",products:[{url:"",name:"",price:"",currency:"SAR",quantity:1,image:"",color:"",size:"",specifications:"",store:"amazon"}],delivery:{type:"home",address:null},notes:""});A.useEffect(()=>{be()},[K.page,T,B]);const be=()=>c(this,null,function*(){var e,s,a;try{R(!0);const s=yield d.getMyAgent();if(null==(e=null==s?void 0:s.data)?void 0:e.agent){C(s.data.agent);const e=s.data.agent._id,a=m(m(m({page:K.page,limit:20},"all"!==T&&{status:T}),"all"!==B&&{customerId:B}),M&&{search:M}),t=yield d.getOrders(e,a);P(t.data.orders||[]),G(t.data.pagination||{page:1,limit:20,total:0,pages:0})}}catch(t){n((null==(a=null==(s=t.response)?void 0:s.data)?void 0:a.message)||"فشل في تحميل البيانات")}finally{R(!1)}}),pe=()=>c(this,null,function*(){var e;try{$(!0);const s=yield d.getMyAgent();if(null==(e=null==s?void 0:s.data)?void 0:e.agent){const e=s.data.agent._id,a=yield d.getCustomers(e,{page:1,limit:100});I(a.data.customers||[])}}catch(s){}finally{$(!1)}}),he=e=>c(this,null,function*(){var s,a,t;if(window.confirm("هل أنت متأكد من إرسال هذا الطلب للمنصة؟")){de(!0);try{const a=yield d.getMyAgent();(null==(s=null==a?void 0:a.data)?void 0:s.agent)&&(yield d.submitOrder(a.data.agent._id,e),r("✅ تم إرسال الطلب للمنصة بنجاح"),te(!1),be())}catch(l){n((null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"فشل في إرسال الطلب")}finally{de(!1)}}}),[ye,je]=A.useState(""),[De,fe]=A.useState(!1),[ve,we]=A.useState(""),Ce=()=>{xe({customerId:"",products:[],delivery:{type:"home",address:null},notes:""}),je(""),we("")},Ae=()=>c(this,null,function*(){var e,s;if(ye.trim()){fe(!0),we("");try{const e=yield w.fetchFromUrl(ye.trim());if(e.data.success&&e.data.product){const s=e.data.product.product||e.data.product,a={url:ye.trim(),name:s.name||"",price:s.price||0,currency:s.currency||"SAR",quantity:1,image:s.image||"",color:s.color||"",size:s.size||"",specifications:s.specifications||"",store:s.store||"amazon"};xe(i(m({},Ne),{products:[...Ne.products,a]})),je(""),r("✅ تم جلب المنتج بنجاح")}else we("فشل في جلب بيانات المنتج. يرجى التأكد من صحة الرابط")}catch(a){we((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.message)||"فشل في جلب المنتج")}finally{fe(!1)}}else we("يرجى إدخال رابط المنتج")}),Oe=(e,s,a)=>{const t=[...Ne.products];t[e]=i(m({},t[e]),{[s]:a}),xe(i(m({},Ne),{products:t}))},Ee=e=>({draft:"bg-gray-100 text-gray-800",pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-700",processing:"bg-purple-100 text-purple-700",purchased:"bg-indigo-100 text-indigo-800",shipped:"bg-cyan-100 text-cyan-800",in_transit:"bg-orange-100 text-orange-800",arrived:"bg-teal-100 text-teal-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800"),Ue=e=>({pending:"bg-yellow-100 text-yellow-800",paid:"bg-green-100 text-green-800",partial:"bg-orange-100 text-orange-800",refunded:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800");if(z&&!l)return u.jsxDEV("div",{className:"flex items-center justify-center py-20",children:u.jsxDEV(g,{className:"animate-spin text-xl md:text-2xl text-primary-600"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:349,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:348,columnNumber:7},this);if(!l)return u.jsxDEV("div",{className:"card text-center py-12",children:[u.jsxDEV(N,{className:"text-4xl text-gray-300 mx-auto mb-4"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:357,columnNumber:9},this),u.jsxDEV("p",{className:"text-lg text-gray-600 mb-4",children:"أنت لست وكيلاً"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:358,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:356,columnNumber:7},this);const Ve=V.filter(e=>"draft"===e.status),Se=Ve.length>0;return u.jsxDEV("div",{children:[u.jsxDEV("div",{className:"mb-4 md:mb-6 flex flex-col md:flex-row md:items-center md:justify-between gap-3 md:gap-4",children:[u.jsxDEV("div",{children:[u.jsxDEV("h1",{className:"text-lg sm:text-xl font-bold mb-1 sm:mb-2 text-gradient",children:"إدارة الطلبات"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:371,columnNumber:11},this),u.jsxDEV("p",{className:"text-sm sm:text-base text-gray-600",children:"إنشاء وإدارة طلبات العملاء"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:372,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:370,columnNumber:9},this),u.jsxDEV("div",{className:"flex gap-2",children:[Se&&u.jsxDEV("button",{onClick:()=>c(this,null,function*(){var e,s,a;if(0!==le.length){if(window.confirm(`هل أنت متأكد من إرسال ${le.length} طلب للمنصة؟`)){de(!0);try{const s=yield d.getMyAgent();(null==(e=null==s?void 0:s.data)?void 0:e.agent)&&(yield d.batchSubmitOrders(s.data.agent._id,{orderIds:le}),r(`✅ تم إرسال ${le.length} طلب بنجاح`),me([]),be())}catch(t){n((null==(a=null==(s=t.response)?void 0:s.data)?void 0:a.message)||"فشل في إرسال الطلبات")}finally{de(!1)}}}else n("يجب اختيار طلبات للإرسال")}),disabled:0===le.length||oe,className:"btn-primary flex items-center gap-2 disabled:opacity-50 text-sm sm:text-base py-2 px-3 sm:py-2.5 sm:px-4",children:[u.jsxDEV(x,{className:"text-sm"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:381,columnNumber:15},this),u.jsxDEV("span",{className:"hidden sm:inline",children:"إرسال المحدد"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:382,columnNumber:15},this),u.jsxDEV("span",{className:"sm:hidden",children:"إرسال"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:383,columnNumber:15},this),le.length>0&&u.jsxDEV("span",{className:"bg-white bg-opacity-30 rounded-full px-1.5 py-0.5 text-xs",children:le.length},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:385,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:376,columnNumber:13},this),u.jsxDEV("button",{onClick:()=>{pe(),Ce(),Q(!0)},className:"btn-primary flex items-center gap-2 text-sm sm:text-base py-2 px-3 sm:py-2.5 sm:px-4",children:[u.jsxDEV(b,{className:"text-sm"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:399,columnNumber:13},this),u.jsxDEV("span",{className:"hidden sm:inline",children:"طلب جديد"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:400,columnNumber:13},this),u.jsxDEV("span",{className:"sm:hidden",children:"جديد"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:401,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:391,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:374,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:369,columnNumber:7},this),u.jsxDEV("div",{className:"card mb-3 md:mb-6 p-2 sm:p-3 md:p-4",children:u.jsxDEV("div",{className:"flex flex-col md:flex-row gap-1.5 sm:gap-2 md:gap-4",children:[u.jsxDEV("div",{className:"flex-1",children:u.jsxDEV("div",{className:"relative",children:[u.jsxDEV(p,{className:"absolute right-2 sm:right-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:411,columnNumber:15},this),u.jsxDEV("input",{type:"text",placeholder:"بحث...",value:M,onChange:e=>{F(e.target.value),G(i(m({},K),{page:1}))},className:"input-field w-full pr-8 sm:pr-10 text-sm sm:text-base py-2 sm:py-2.5"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:412,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:410,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:409,columnNumber:11},this),u.jsxDEV("select",{value:T,onChange:e=>{L(e.target.value),G(i(m({},K),{page:1}))},className:"input-field text-sm sm:text-base py-2 sm:py-2.5",children:[u.jsxDEV("option",{value:"all",children:"جميع الحالات"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:432,columnNumber:13},this),u.jsxDEV("option",{value:"draft",children:"مسودة"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:433,columnNumber:13},this),u.jsxDEV("option",{value:"pending",children:"قيد الانتظار"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:434,columnNumber:13},this),u.jsxDEV("option",{value:"confirmed",children:"مؤكد"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:435,columnNumber:13},this),u.jsxDEV("option",{value:"processing",children:"قيد المعالجة"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:436,columnNumber:13},this),u.jsxDEV("option",{value:"purchased",children:"تم الشراء"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:437,columnNumber:13},this),u.jsxDEV("option",{value:"shipped",children:"تم الشحن"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:438,columnNumber:13},this),u.jsxDEV("option",{value:"delivered",children:"تم التسليم"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:439,columnNumber:13},this),u.jsxDEV("option",{value:"cancelled",children:"ملغي"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:440,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:424,columnNumber:11},this),u.jsxDEV("select",{value:B,onChange:e=>{J(e.target.value),G(i(m({},K),{page:1}))},className:"input-field text-sm sm:text-base py-2 sm:py-2.5",children:[u.jsxDEV("option",{value:"all",children:"جميع العملاء"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:450,columnNumber:13},this),_.map(e=>u.jsxDEV("option",{value:e._id,children:e.name},e._id,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:452,columnNumber:15},this))]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:442,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:408,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:407,columnNumber:7},this),z?u.jsxDEV("div",{className:"flex items-center justify-center py-20",children:u.jsxDEV(g,{className:"animate-spin text-xl md:text-2xl text-primary-600"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:463,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:462,columnNumber:9},this):0===V.length?u.jsxDEV("div",{className:"card text-center py-12",children:[u.jsxDEV(N,{className:"text-4xl text-gray-300 mx-auto mb-4"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:467,columnNumber:11},this),u.jsxDEV("p",{className:"text-lg text-gray-600 mb-2",children:"لا توجد طلبات"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:468,columnNumber:11},this),u.jsxDEV("button",{onClick:()=>{pe(),Ce(),Q(!0)},className:"btn-primary mt-4",children:"إنشاء طلب جديد"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:469,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:466,columnNumber:9},this):u.jsxDEV(u.Fragment,{children:[u.jsxDEV("div",{className:"card hidden lg:block overflow-x-auto",children:u.jsxDEV("table",{className:"w-full",children:[u.jsxDEV("thead",{children:u.jsxDEV("tr",{className:"border-b border-gray-200",children:[u.jsxDEV("th",{className:"text-right py-3 px-4 font-semibold w-12",children:u.jsxDEV("input",{type:"checkbox",checked:le.length===Ve.length&&Ve.length>0,onChange:e=>{e.target.checked?me(Ve.map(e=>e._id)):me([])},className:"rounded"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:488,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:487,columnNumber:19},this),u.jsxDEV("th",{className:"text-right py-3 px-4 font-semibold",children:"رقم الطلب"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:501,columnNumber:19},this),u.jsxDEV("th",{className:"text-right py-3 px-4 font-semibold",children:"العميل"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:502,columnNumber:19},this),u.jsxDEV("th",{className:"text-right py-3 px-4 font-semibold",children:"المبلغ"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:503,columnNumber:19},this),u.jsxDEV("th",{className:"text-right py-3 px-4 font-semibold",children:"دفع العميل"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:504,columnNumber:19},this),u.jsxDEV("th",{className:"text-right py-3 px-4 font-semibold",children:"دفع الوكيل"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:505,columnNumber:19},this),u.jsxDEV("th",{className:"text-right py-3 px-4 font-semibold",children:"الحالة"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:506,columnNumber:19},this),u.jsxDEV("th",{className:"text-right py-3 px-4 font-semibold",children:"التاريخ"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:507,columnNumber:19},this),u.jsxDEV("th",{className:"text-right py-3 px-4 font-semibold",children:"الإجراءات"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:508,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:486,columnNumber:17},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:485,columnNumber:15},this),u.jsxDEV("tbody",{children:V.map(e=>{var s,a,t;return u.jsxDEV("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[u.jsxDEV("td",{className:"py-3 px-4",children:"draft"===e.status&&u.jsxDEV("input",{type:"checkbox",checked:le.includes(e._id),onChange:s=>{s.target.checked?me([...le,e._id]):me(le.filter(s=>s!==e._id))},className:"rounded"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:516,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:514,columnNumber:21},this),u.jsxDEV("td",{className:"py-3 px-4",children:u.jsxDEV("span",{className:"font-mono font-semibold text-primary-600",children:e.orderNumber},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:531,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:530,columnNumber:21},this),u.jsxDEV("td",{className:"py-3 px-4",children:u.jsxDEV("div",{children:[u.jsxDEV("p",{className:"font-semibold",children:(null==(s=e.customer)?void 0:s.name)||"عميل"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:535,columnNumber:25},this),u.jsxDEV("p",{className:"text-xs text-gray-500",children:null==(a=e.customer)?void 0:a.phone},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:536,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:534,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:533,columnNumber:21},this),u.jsxDEV("td",{className:"py-3 px-4",children:u.jsxDEV("span",{className:"font-semibold",children:O((null==(t=e.pricing)?void 0:t.totalCost)||0,"SAR")},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:540,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:539,columnNumber:21},this),u.jsxDEV("td",{className:"py-3 px-4",children:u.jsxDEV("span",{className:`px-2 py-1 rounded text-xs ${Ue(e.customerPaymentStatus)}`,children:"paid"===e.customerPaymentStatus?"مدفوع":"معلق"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:545,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:544,columnNumber:21},this),u.jsxDEV("td",{className:"py-3 px-4",children:u.jsxDEV("span",{className:`px-2 py-1 rounded text-xs ${Ue(e.agentPaymentStatus)}`,children:"paid"===e.agentPaymentStatus?"مدفوع":"معلق"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:550,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:549,columnNumber:21},this),u.jsxDEV("td",{className:"py-3 px-4",children:u.jsxDEV("span",{className:`px-2 py-1 rounded text-xs ${Ee(e.status)}`,children:E(e.status)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:555,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:554,columnNumber:21},this),u.jsxDEV("td",{className:"py-3 px-4",children:u.jsxDEV("span",{className:"text-sm text-gray-600",children:U(e.createdAt)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:560,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:559,columnNumber:21},this),u.jsxDEV("td",{className:"py-3 px-4",children:u.jsxDEV("div",{className:"flex items-center gap-2",children:[u.jsxDEV("button",{onClick:()=>{ne(e),X(!0)},className:"p-2 text-primary-600 hover:bg-primary-50 rounded",title:"عرض",children:u.jsxDEV(h,{},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:572,columnNumber:27},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:564,columnNumber:25},this),"draft"===e.status&&u.jsxDEV("button",{onClick:()=>{ne(e),te(!0)},className:"p-2 text-green-600 hover:bg-green-50 rounded",title:"إرسال للمنصة",children:u.jsxDEV(x,{},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:583,columnNumber:29},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:575,columnNumber:27},this),"pending"===e.customerPaymentStatus&&u.jsxDEV("button",{onClick:()=>{ne(e),Z(!0)},className:"p-2 text-blue-600 hover:bg-blue-50 rounded",title:"تسجيل دفع العميل",children:u.jsxDEV(y,{},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:595,columnNumber:29},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:587,columnNumber:27},this),"paid"===e.customerPaymentStatus&&"pending"===e.agentPaymentStatus&&u.jsxDEV("button",{onClick:()=>{ne(e),se(!0)},className:"p-2 text-yellow-600 hover:bg-yellow-50 rounded",title:"تسجيل دفع الوكيل",children:u.jsxDEV(y,{},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:607,columnNumber:29},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:599,columnNumber:27},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:563,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:562,columnNumber:21},this)]},e._id,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:513,columnNumber:19},this)})},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:511,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:484,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:483,columnNumber:11},this),u.jsxDEV("div",{className:"lg:hidden space-y-2",children:V.map(e=>{var s,a,t;return u.jsxDEV("div",{className:"card p-3",children:[u.jsxDEV("div",{className:"flex items-start justify-between mb-2",children:[u.jsxDEV("div",{className:"flex-1 min-w-0",children:[u.jsxDEV("p",{className:"font-mono font-semibold text-sm text-primary-600 mb-0.5 truncate",children:e.orderNumber},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:624,columnNumber:21},this),u.jsxDEV("p",{className:"font-medium text-sm truncate",children:(null==(s=e.customer)?void 0:s.name)||"عميل"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:625,columnNumber:21},this),u.jsxDEV("p",{className:"text-xs text-gray-500 truncate",children:null==(a=e.customer)?void 0:a.phone},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:626,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:623,columnNumber:19},this),"draft"===e.status&&u.jsxDEV("input",{type:"checkbox",checked:le.includes(e._id),onChange:s=>{s.target.checked?me([...le,e._id]):me(le.filter(s=>s!==e._id))},className:"rounded mt-1 flex-shrink-0 ml-2"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:629,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:622,columnNumber:17},this),u.jsxDEV("div",{className:"grid grid-cols-2 gap-2 mb-2 pt-2 border-t border-gray-200",children:[u.jsxDEV("div",{children:[u.jsxDEV("p",{className:"text-xs text-gray-500 mb-0.5",children:"المبلغ"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:646,columnNumber:21},this),u.jsxDEV("p",{className:"font-semibold text-sm",children:O((null==(t=e.pricing)?void 0:t.totalCost)||0,"SAR")},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:647,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:645,columnNumber:19},this),u.jsxDEV("div",{children:[u.jsxDEV("p",{className:"text-xs text-gray-500 mb-0.5",children:"الحالة"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:652,columnNumber:21},this),u.jsxDEV("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs ${Ee(e.status)}`,children:E(e.status)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:653,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:651,columnNumber:19},this),u.jsxDEV("div",{children:[u.jsxDEV("p",{className:"text-xs text-gray-500 mb-0.5",children:"دفع العميل"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:658,columnNumber:21},this),u.jsxDEV("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs ${Ue(e.customerPaymentStatus)}`,children:"paid"===e.customerPaymentStatus?"مدفوع":"معلق"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:659,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:657,columnNumber:19},this),u.jsxDEV("div",{children:[u.jsxDEV("p",{className:"text-xs text-gray-500 mb-0.5",children:"دفع الوكيل"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:664,columnNumber:21},this),u.jsxDEV("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs ${Ue(e.agentPaymentStatus)}`,children:"paid"===e.agentPaymentStatus?"مدفوع":"معلق"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:665,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:663,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:644,columnNumber:17},this),u.jsxDEV("div",{className:"flex flex-wrap gap-1.5 pt-2 border-t border-gray-200",children:[u.jsxDEV("button",{onClick:()=>{ne(e),X(!0)},className:"flex-1 min-w-[80px] btn-secondary py-1.5 text-xs flex items-center justify-center gap-1",children:[u.jsxDEV(h,{className:"text-xs"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:679,columnNumber:21},this),"عرض"]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:672,columnNumber:19},this),"draft"===e.status&&u.jsxDEV("button",{onClick:()=>{ne(e),te(!0)},className:"flex-1 min-w-[80px] bg-green-100 text-green-700 hover:bg-green-200 py-1.5 text-xs rounded flex items-center justify-center gap-1",children:[u.jsxDEV(x,{className:"text-xs"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:690,columnNumber:23},this),"إرسال"]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:683,columnNumber:21},this),"pending"===e.customerPaymentStatus&&u.jsxDEV("button",{onClick:()=>{ne(e),Z(!0)},className:"flex-1 min-w-[80px] bg-blue-100 text-blue-600 hover:bg-blue-200 py-1.5 text-xs rounded flex items-center justify-center gap-1",children:[u.jsxDEV(y,{className:"text-xs"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:702,columnNumber:23},this),"دفع عميل"]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:695,columnNumber:21},this),"paid"===e.customerPaymentStatus&&"pending"===e.agentPaymentStatus&&u.jsxDEV("button",{onClick:()=>{ne(e),se(!0)},className:"flex-1 min-w-[80px] bg-yellow-100 text-yellow-700 hover:bg-yellow-200 py-1.5 text-xs rounded flex items-center justify-center gap-1",children:[u.jsxDEV(y,{className:"text-xs"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:714,columnNumber:23},this),"دفع وكيل"]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:707,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:671,columnNumber:17},this)]},e._id,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:621,columnNumber:15},this)})},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:619,columnNumber:11},this),K.pages>1&&u.jsxDEV("div",{className:"flex items-center justify-center gap-2 mt-6",children:[u.jsxDEV("button",{onClick:()=>G(i(m({},K),{page:K.page-1})),disabled:1===K.page,className:"btn-secondary disabled:opacity-50",children:"السابق"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:726,columnNumber:15},this),u.jsxDEV("span",{className:"text-sm text-gray-600",children:["صفحة ",K.page," من ",K.pages]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:733,columnNumber:15},this),u.jsxDEV("button",{onClick:()=>G(i(m({},K),{page:K.page+1})),disabled:K.page>=K.pages,className:"btn-secondary disabled:opacity-50",children:"التالي"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:736,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:725,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:481,columnNumber:9},this),H&&u.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxDEV("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto p-4 md:p-6",children:[u.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[u.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"إنشاء طلب جديد"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:753,columnNumber:15},this),u.jsxDEV("button",{onClick:()=>{Q(!1),Ce()},className:"text-gray-400 hover:text-gray-600",children:u.jsxDEV(j,{className:"text-xl"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:761,columnNumber:17},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:754,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:752,columnNumber:13},this),u.jsxDEV("form",{onSubmit:e=>c(this,null,function*(){var s,a,t;if(e.preventDefault(),Ne.customerId)if(0!==Ne.products.length&&Ne.products[0].url){ce(!0);try{const e=yield d.getMyAgent();if(null==(s=null==e?void 0:e.data)?void 0:s.agent){const s={customerId:Ne.customerId,products:Ne.products.map(e=>({url:e.url,name:e.name,price:parseFloat(e.price)||0,currency:e.currency||"SAR",quantity:parseInt(e.quantity)||1,image:e.image||"",color:e.color||"",size:e.size||"",specifications:e.specifications||"",store:e.store||"amazon"})),delivery:Ne.delivery,notes:Ne.notes};yield d.createOrder(e.data.agent._id,s),r("✅ تم إنشاء الطلب بنجاح"),Q(!1),Ce(),be()}}catch(l){n((null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"فشل في إنشاء الطلب")}finally{ce(!1)}}else n("يجب إضافة منتج على الأقل");else n("يجب اختيار عميل")}),className:"space-y-4",children:[u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العميل *"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:767,columnNumber:17},this),u.jsxDEV("select",{value:Ne.customerId,onChange:e=>xe(i(m({},Ne),{customerId:e.target.value})),required:!0,className:"input-field w-full",disabled:q,children:[u.jsxDEV("option",{value:"",children:"اختر عميلاً"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:777,columnNumber:19},this),_.map(e=>u.jsxDEV("option",{value:e._id,children:[e.name," - ",e.phone]},e._id,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:779,columnNumber:21},this))]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:770,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:766,columnNumber:15},this),u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المنتجات *"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:788,columnNumber:17},this),u.jsxDEV("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[u.jsxDEV("p",{className:"text-sm font-semibold text-blue-900 mb-2",children:"إضافة منتج من الرابط (مثل السلة الذكية)"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:794,columnNumber:19},this),u.jsxDEV("div",{className:"flex gap-2",children:[u.jsxDEV("input",{type:"url",value:ye,onChange:e=>{je(e.target.value),we("")},onKeyPress:e=>"Enter"===e.key&&Ae(),placeholder:"https://www.amazon.com/... أو https://www.noon.com/...",className:"input-field flex-1 text-sm",disabled:De},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:798,columnNumber:21},this),u.jsxDEV("button",{type:"button",onClick:Ae,disabled:De||!ye.trim(),className:"btn-primary whitespace-nowrap flex items-center gap-2 disabled:opacity-50",children:De?u.jsxDEV(u.Fragment,{children:[u.jsxDEV(g,{className:"animate-spin"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:818,columnNumber:27},this),"جاري الجلب..."]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:817,columnNumber:25},this):u.jsxDEV(u.Fragment,{children:[u.jsxDEV(D,{},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:823,columnNumber:27},this),"جلب وإضافة"]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:822,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:810,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:797,columnNumber:19},this),ve&&u.jsxDEV("p",{className:"text-xs text-red-600 mt-2",children:ve},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:830,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:793,columnNumber:17},this),0===Ne.products.length?u.jsxDEV("div",{className:"text-center py-8 border border-dashed border-gray-300 rounded-lg",children:[u.jsxDEV(D,{className:"text-3xl text-gray-300 mx-auto mb-2"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:837,columnNumber:21},this),u.jsxDEV("p",{className:"text-sm text-gray-500",children:"لا توجد منتجات"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:838,columnNumber:21},this),u.jsxDEV("p",{className:"text-xs text-gray-400 mt-1",children:"استخدم الحقل أعلاه لإضافة منتجات"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:839,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:836,columnNumber:19},this):u.jsxDEV("div",{className:"space-y-3",children:Ne.products.map((e,s)=>u.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[u.jsxDEV("div",{className:"flex items-start justify-between mb-3",children:[u.jsxDEV("div",{className:"flex-1",children:[u.jsxDEV("h4",{className:"font-semibold text-gray-900 mb-1",children:e.name||`منتج ${s+1}`},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:847,columnNumber:29},this),u.jsxDEV("p",{className:"text-xs text-gray-500 break-all",children:e.url},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:850,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:846,columnNumber:27},this),u.jsxDEV("button",{type:"button",onClick:()=>(e=>{const s=Ne.products.filter((s,a)=>a!==e);xe(i(m({},Ne),{products:s}))})(s),className:"text-red-600 hover:text-red-700 p-1",title:"حذف المنتج",children:u.jsxDEV(f,{},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:858,columnNumber:29},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:852,columnNumber:27},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:845,columnNumber:25},this),u.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs text-gray-600 mb-1",children:"السعر"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:864,columnNumber:29},this),u.jsxDEV("input",{type:"number",value:e.price,onChange:e=>Oe(s,"price",parseFloat(e.target.value)||0),min:"0",step:"0.01",className:"input-field w-full text-sm"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:865,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:863,columnNumber:27},this),u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs text-gray-600 mb-1",children:"العملة"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:875,columnNumber:29},this),u.jsxDEV("select",{value:e.currency,onChange:e=>Oe(s,"currency",e.target.value),className:"input-field w-full text-sm",children:[u.jsxDEV("option",{value:"SAR",children:"SAR"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:881,columnNumber:31},this),u.jsxDEV("option",{value:"USD",children:"USD"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:882,columnNumber:31},this),u.jsxDEV("option",{value:"EUR",children:"EUR"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:883,columnNumber:31},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:876,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:874,columnNumber:27},this),u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs text-gray-600 mb-1",children:"الكمية"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:887,columnNumber:29},this),u.jsxDEV("input",{type:"number",value:e.quantity,onChange:e=>Oe(s,"quantity",parseInt(e.target.value)||1),min:"1",className:"input-field w-full text-sm"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:888,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:886,columnNumber:27},this),u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs text-gray-600 mb-1",children:"المتجر"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:897,columnNumber:29},this),u.jsxDEV("select",{value:e.store,onChange:e=>Oe(s,"store",e.target.value),className:"input-field w-full text-sm",children:[u.jsxDEV("option",{value:"amazon",children:"Amazon"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:903,columnNumber:31},this),u.jsxDEV("option",{value:"ebay",children:"eBay"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:904,columnNumber:31},this),u.jsxDEV("option",{value:"noon",children:"Noon"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:905,columnNumber:31},this),u.jsxDEV("option",{value:"other",children:"أخرى"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:906,columnNumber:31},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:898,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:896,columnNumber:27},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:862,columnNumber:25},this),u.jsxDEV("div",{className:"grid grid-cols-2 gap-3 mt-3 pt-3 border-t border-gray-200",children:[u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs text-gray-600 mb-1",children:"اللون (اختياري)"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:914,columnNumber:29},this),u.jsxDEV("input",{type:"text",value:e.color,onChange:e=>Oe(s,"color",e.target.value),className:"input-field w-full text-sm",placeholder:"مثل: أسود، أبيض..."},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:915,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:913,columnNumber:27},this),u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs text-gray-600 mb-1",children:"المقاس (اختياري)"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:924,columnNumber:29},this),u.jsxDEV("input",{type:"text",value:e.size,onChange:e=>Oe(s,"size",e.target.value),className:"input-field w-full text-sm",placeholder:"مثل: L، 42..."},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:925,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:923,columnNumber:27},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:912,columnNumber:25},this)]},s,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:844,columnNumber:23},this))},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:842,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:787,columnNumber:15},this),u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ملاحظات"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:941,columnNumber:17},this),u.jsxDEV("textarea",{value:Ne.notes,onChange:e=>xe(i(m({},Ne),{notes:e.target.value})),rows:3,className:"input-field w-full",placeholder:"ملاحظات عن الطلب..."},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:942,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:940,columnNumber:15},this),u.jsxDEV("div",{className:"flex gap-3 mt-6",children:[u.jsxDEV("button",{type:"submit",disabled:ie,className:"flex-1 btn-primary disabled:opacity-50 flex items-center justify-center gap-2",children:[u.jsxDEV(v,{},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:957,columnNumber:19},this),ie?"جاري الإنشاء...":"إنشاء الطلب"]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:952,columnNumber:17},this),u.jsxDEV("button",{type:"button",onClick:()=>{Q(!1),Ce()},className:"flex-1 btn-secondary",children:"إلغاء"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:960,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:951,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:765,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:751,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:750,columnNumber:9},this),W&&re&&u.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxDEV("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto p-4 md:p-6",children:[u.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[u.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:["تفاصيل الطلب #",re.orderNumber]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:981,columnNumber:15},this),u.jsxDEV("button",{onClick:()=>{X(!1),ne(null)},className:"text-gray-400 hover:text-gray-600",children:u.jsxDEV(j,{className:"text-xl"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:989,columnNumber:17},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:982,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:980,columnNumber:13},this),u.jsxDEV("div",{className:"space-y-4",children:[u.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxDEV("div",{children:[u.jsxDEV("p",{className:"text-sm text-gray-500",children:"العميل"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:996,columnNumber:19},this),u.jsxDEV("p",{className:"font-semibold",children:null==(e=re.customer)?void 0:e.name},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:997,columnNumber:19},this),u.jsxDEV("p",{className:"text-sm text-gray-600",children:null==(s=re.customer)?void 0:s.phone},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:998,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:995,columnNumber:17},this),u.jsxDEV("div",{children:[u.jsxDEV("p",{className:"text-sm text-gray-500",children:"الحالة"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1001,columnNumber:19},this),u.jsxDEV("span",{className:`px-2 py-1 rounded text-xs ${Ee(re.status)}`,children:E(re.status)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1002,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1e3,columnNumber:17},this),u.jsxDEV("div",{children:[u.jsxDEV("p",{className:"text-sm text-gray-500",children:"إجمالي المبلغ"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1007,columnNumber:19},this),u.jsxDEV("p",{className:"font-semibold text-lg",children:O((null==(a=re.pricing)?void 0:a.totalCost)||0,"SAR")},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1008,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1006,columnNumber:17},this),u.jsxDEV("div",{children:[u.jsxDEV("p",{className:"text-sm text-gray-500",children:"العمولة"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1013,columnNumber:19},this),u.jsxDEV("p",{className:"font-semibold text-green-600",children:O(re.commission||0,"SAR")},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1014,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1012,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:994,columnNumber:15},this),u.jsxDEV("div",{className:"border-t pt-4",children:[u.jsxDEV("h3",{className:"font-semibold mb-3",children:"المنتجات"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1021,columnNumber:17},this),u.jsxDEV("div",{className:"space-y-2",children:null==(t=re.products)?void 0:t.map((e,s)=>u.jsxDEV("div",{className:"border border-gray-200 rounded p-3",children:[u.jsxDEV("p",{className:"font-semibold",children:e.name||"منتج"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1025,columnNumber:23},this),u.jsxDEV("p",{className:"text-sm text-gray-600",children:e.url},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1026,columnNumber:23},this),u.jsxDEV("div",{className:"flex gap-4 mt-2 text-sm",children:[u.jsxDEV("span",{children:["الكمية: ",e.quantity]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1028,columnNumber:25},this),u.jsxDEV("span",{children:["السعر: ",O(e.price||0,e.currency||"SAR")]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1029,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1027,columnNumber:23},this)]},s,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1024,columnNumber:21},this))},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1022,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1020,columnNumber:15},this),u.jsxDEV("div",{className:"flex gap-3",children:[u.jsxDEV("button",{onClick:()=>{X(!1),Z(!0)},disabled:"paid"===re.customerPaymentStatus,className:"flex-1 btn-secondary disabled:opacity-50",children:"تسجيل دفع العميل"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1037,columnNumber:17},this),"draft"===re.status&&u.jsxDEV("button",{onClick:()=>{X(!1),te(!0)},className:"flex-1 btn-primary",children:"إرسال للمنصة"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1048,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1036,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:993,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:979,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:978,columnNumber:9},this),ae&&re&&u.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxDEV("div",{className:"bg-white rounded-lg max-w-md w-full p-4 md:p-6",children:[u.jsxDEV("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"تأكيد الإرسال"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1068,columnNumber:13},this),u.jsxDEV("p",{className:"text-gray-600 mb-4",children:["هل أنت متأكد من إرسال الطلب #",re.orderNumber," للمنصة؟"]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1069,columnNumber:13},this),u.jsxDEV("div",{className:"flex gap-3",children:[u.jsxDEV("button",{onClick:()=>he(re._id),disabled:oe,className:"flex-1 btn-primary disabled:opacity-50",children:oe?"جاري الإرسال...":"تأكيد"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1073,columnNumber:15},this),u.jsxDEV("button",{onClick:()=>{te(!1),ne(null)},className:"flex-1 btn-secondary",children:"إلغاء"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1080,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1072,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1067,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1066,columnNumber:9},this),Y&&re&&u.jsxDEV(S,{order:re,onClose:()=>{Z(!1),ne(null)},onSubmit:e=>c(this,null,function*(){var s,a,t;ge(!0);try{const a=yield d.getMyAgent();(null==(s=null==a?void 0:a.data)?void 0:s.agent)&&(yield d.markCustomerPayment(a.data.agent._id,re._id,e),r("✅ تم تسجيل دفع العميل بنجاح"),Z(!1),ne(null),be())}catch(l){n((null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"فشل في تسجيل الدفع")}finally{ge(!1)}}),loading:ue},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1096,columnNumber:9},this),ee&&re&&u.jsxDEV(k,{order:re,onClose:()=>{se(!1),ne(null)},onSubmit:e=>c(this,null,function*(){var s,a,t;ge(!0);try{const a=yield d.getMyAgent();(null==(s=null==a?void 0:a.data)?void 0:s.agent)&&(yield d.markAgentPayment(a.data.agent._id,re._id,e),r("✅ تم تسجيل دفع الوكيل بنجاح"),se(!1),ne(null),be())}catch(l){n((null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"فشل في تسجيل الدفع")}finally{ge(!1)}}),loading:ue},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1109,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:367,columnNumber:5},this)}function S({order:e,onClose:s,onSubmit:a,loading:t}){const[r,n]=A.useState("cash"),[l,m]=A.useState((new Date).toISOString().split("T")[0]),[i,c]=A.useState("");return u.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-3 md:p-4",children:u.jsxDEV("div",{className:"bg-white rounded-lg max-w-sm sm:max-w-md w-full p-3 sm:p-4 md:p-5 max-h-[85vh] overflow-y-auto shadow-xl",children:[u.jsxDEV("h2",{className:"text-sm sm:text-base md:text-lg font-bold text-gray-900 mb-2 sm:mb-3 md:mb-4",children:"تسجيل دفع العميل"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1141,columnNumber:9},this),u.jsxDEV("form",{onSubmit:e=>{e.preventDefault(),a({paymentMethod:r,paymentDate:l,notes:i})},className:"space-y-3 sm:space-y-4",children:[u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"طريقة الدفع"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1144,columnNumber:13},this),u.jsxDEV("select",{value:r,onChange:e=>n(e.target.value),className:"input-field w-full text-sm sm:text-base py-2 sm:py-2.5 px-3",required:!0,children:[u.jsxDEV("option",{value:"cash",children:"نقداً"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1151,columnNumber:15},this),u.jsxDEV("option",{value:"transfer",children:"تحويل بنكي"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1152,columnNumber:15},this),u.jsxDEV("option",{value:"other",children:"أخرى"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1153,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1145,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1143,columnNumber:11},this),u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"تاريخ الدفع"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1157,columnNumber:13},this),u.jsxDEV("input",{type:"date",value:l,onChange:e=>m(e.target.value),className:"input-field w-full text-sm sm:text-base py-2 sm:py-2.5 px-3",required:!0},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1158,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1156,columnNumber:11},this),u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"ملاحظات"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1167,columnNumber:13},this),u.jsxDEV("textarea",{value:i,onChange:e=>c(e.target.value),rows:3,className:"input-field w-full text-sm sm:text-base py-2 sm:py-2.5 px-3",placeholder:"ملاحظات عن الدفع..."},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1168,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1166,columnNumber:11},this),u.jsxDEV("div",{className:"flex gap-2 sm:gap-3 pt-2",children:[u.jsxDEV("button",{type:"submit",disabled:t,className:"flex-1 btn-primary disabled:opacity-50 text-sm sm:text-base py-2 sm:py-2.5",children:t?"جاري التسجيل...":"تسجيل"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1177,columnNumber:13},this),u.jsxDEV("button",{type:"button",onClick:s,className:"flex-1 btn-secondary text-sm sm:text-base py-2 sm:py-2.5",children:"إلغاء"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1184,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1176,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1142,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1140,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1139,columnNumber:5},this)}function k({order:e,onClose:s,onSubmit:a,loading:t}){var r;const[n,l]=A.useState("wallet"),[m,i]=A.useState((new Date).toISOString().split("T")[0]),[o,d]=A.useState(""),[N,x]=A.useState(""),[b,p]=A.useState(""),[h,y]=A.useState(null),[j,D]=A.useState(!1);A.useEffect(()=>{"wallet"===n?f():y(null)},[n]);const f=()=>c(this,null,function*(){var e;try{D(!0);const{walletAPI:s}=yield C(()=>c(this,null,function*(){const{walletAPI:e}=yield import("./index-Ctx_GovF.js").then(e=>e.ay);return{walletAPI:e}}),__vite__mapDeps([0,1,2,3,4])),a=yield s.get();(null==(e=a.data)?void 0:e.wallet)&&y(a.data.wallet)}catch(s){}finally{D(!1)}}),v=((null==(r=e.pricing)?void 0:r.totalCost)||0)-(e.commission||0);return u.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-end sm:items-center z-50 p-2 sm:p-3 md:p-4",children:u.jsxDEV("div",{className:"bg-white rounded-t-xl sm:rounded-lg w-full sm:max-w-md sm:w-auto p-3 sm:p-4 md:p-5 max-h-[90vh] sm:max-h-[85vh] overflow-y-auto shadow-xl sm:shadow-2xl",children:[u.jsxDEV("h2",{className:"text-sm sm:text-base md:text-lg font-bold text-gray-900 mb-2 sm:mb-3 md:mb-4",children:"تسجيل دفع الوكيل للمنصة"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1264,columnNumber:9},this),u.jsxDEV("form",{onSubmit:s=>{var t;if(s.preventDefault(),"transfer"!==n||o){if("wallet"===n){const s=((null==(t=e.pricing)?void 0:t.totalCost)||0)-(e.commission||0);if(!h)return void alert("فشل في تحميل رصيد المحفظة. يرجى المحاولة مرة أخرى");if(h.balance<s)return void alert(`رصيد المحفظة غير كافي. الرصيد المتاح: ${O(h.balance,h.currency||"SAR")}`)}a({paymentMethod:n,paymentDate:m,transactionId:o,proofUrl:N,notes:b})}else alert("يرجى إدخال رقم العملية للتحويل البنكي")},className:"space-y-2.5 sm:space-y-3 md:space-y-4",children:[u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"طريقة الدفع"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1267,columnNumber:13},this),u.jsxDEV("select",{value:n,onChange:e=>l(e.target.value),className:"input-field w-full text-sm sm:text-base py-2 sm:py-2.5 px-3",required:!0,children:[u.jsxDEV("option",{value:"",children:"-- اختر طريقة الدفع --"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1274,columnNumber:15},this),u.jsxDEV("option",{value:"wallet",children:"محفظة"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1275,columnNumber:15},this),u.jsxDEV("option",{value:"transfer",children:"تحويل بنكي"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1276,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1268,columnNumber:13},this),"wallet"===n&&h&&u.jsxDEV("div",{className:"mt-1.5 sm:mt-2 p-2 sm:p-3 bg-blue-50 rounded-lg",children:[u.jsxDEV("p",{className:"text-xs sm:text-sm text-blue-700",children:["الرصيد المتاح: ",u.jsxDEV("span",{className:"font-bold",children:O(h.balance||0,h.currency||"SAR")},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1281,columnNumber:34},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1280,columnNumber:17},this),u.jsxDEV("p",{className:"text-xs text-blue-600 mt-0.5 sm:mt-1",children:["المبلغ المطلوب: ",O(v,"SAR")]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1283,columnNumber:17},this),h.balance<v&&u.jsxDEV("p",{className:"text-xs text-red-600 mt-0.5 sm:mt-1",children:"⚠️ الرصيد غير كافي"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1287,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1279,columnNumber:15},this),"wallet"===n&&j&&u.jsxDEV("div",{className:"mt-1.5 sm:mt-2 flex items-center gap-1.5 sm:gap-2 text-xs sm:text-sm text-gray-600",children:[u.jsxDEV(g,{className:"animate-spin text-xs sm:text-sm"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1295,columnNumber:17},this),"جاري تحميل رصيد المحفظة..."]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1294,columnNumber:15},this),"wallet"===n&&h&&h.balance>=v&&u.jsxDEV("div",{className:"mt-1.5 sm:mt-2 p-1.5 sm:p-2 bg-green-50 rounded-lg",children:u.jsxDEV("p",{className:"text-xs text-green-800",children:"✓ سيتم خصم المبلغ تلقائياً من المحفظة"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1301,columnNumber:17},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1300,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1266,columnNumber:11},this),u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"تاريخ الدفع"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1308,columnNumber:13},this),u.jsxDEV("input",{type:"date",value:m,onChange:e=>i(e.target.value),className:"input-field w-full text-sm sm:text-base py-2 sm:py-2.5 px-3",required:!0},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1309,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1307,columnNumber:11},this),"transfer"===n&&u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"رقم العملية *"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1319,columnNumber:15},this),u.jsxDEV("input",{type:"text",value:o,onChange:e=>d(e.target.value),className:"input-field w-full text-sm sm:text-base py-2 sm:py-2.5 px-3",placeholder:"رقم العملية أو المرجع...",required:!0},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1320,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1318,columnNumber:13},this),"wallet"===n&&h&&h.balance>=v&&u.jsxDEV("div",{className:"p-1.5 sm:p-2 md:p-3 bg-green-50 rounded-lg",children:u.jsxDEV("p",{className:"text-xs text-green-800",children:"✓ سيتم خصم المبلغ تلقائياً من المحفظة عند التأكيد"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1332,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1331,columnNumber:13},this),u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"رابط إيصال الدفع"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1338,columnNumber:13},this),u.jsxDEV("input",{type:"url",value:N,onChange:e=>x(e.target.value),className:"input-field w-full text-sm sm:text-base py-2 sm:py-2.5 px-3",placeholder:"https://..."},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1339,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1337,columnNumber:11},this),u.jsxDEV("div",{children:[u.jsxDEV("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"ملاحظات"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1348,columnNumber:13},this),u.jsxDEV("textarea",{value:b,onChange:e=>p(e.target.value),rows:3,className:"input-field w-full text-sm sm:text-base py-2 sm:py-2.5 px-3",placeholder:"ملاحظات عن الدفع..."},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1349,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1347,columnNumber:11},this),u.jsxDEV("div",{className:"flex gap-2 sm:gap-3 pt-2",children:[u.jsxDEV("button",{type:"submit",disabled:t,className:"flex-1 btn-primary disabled:opacity-50 text-sm sm:text-base py-2 sm:py-2.5",children:t?"جاري التسجيل...":"تسجيل"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1358,columnNumber:13},this),u.jsxDEV("button",{type:"button",onClick:s,className:"flex-1 btn-secondary text-sm sm:text-base py-2 sm:py-2.5",children:"إلغاء"},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1365,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1357,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1265,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1263,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/cct33/Downloads/2yam/src/pages/agent/AgentOrders.jsx",lineNumber:1262,columnNumber:5},this)}export{V as default};
